\documentclass{standalone}
\usepackage{aes}
\usepackage{comment}
\begin{document}
%\begin{figure}
%\centering
\begin{tikzpicture}
\AesInit

\AesRound[0]
{\TFill[upperactive]{ss02}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss31}} % state input
{} % round key
{\TFill[upperactive]{ss02}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss31}} % state after AK
{\TFill[upperactive]{ss02}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss31}} % state after SB
{\TFill[upperactive]{ss02}\TFill[upperactive]{ss12}\TFill[upperactive]{ss22}\TFill[upperactive]{ss32}} % state after SR

\AesRound[1]
{\BFill[loweractive]{ss00}\BFill[loweractive]{ss01}\BFill[loweractive]{ss02}\BFill[loweractive]{ss03}\BFill[loweractive]{ss10}\BFill[loweractive]{ss11}\BFill[loweractive]{ss12}\BFill[loweractive]{ss13}\BFill[loweractive]{ss20}\BFill[loweractive]{ss21}\BFill[loweractive]{ss22}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\BFill[loweractive]{ss31}\TFill[upperactive]{ss32}\BFill[loweractive]{ss32}\BFill[loweractive]{ss33}} % state input
{} % round key
{\BFill[loweractive]{ss00}\BFill[loweractive]{ss01}\BFill[loweractive]{ss02}\BFill[loweractive]{ss03}\BFill[loweractive]{ss10}\BFill[loweractive]{ss11}\BFill[loweractive]{ss12}\BFill[loweractive]{ss13}\BFill[loweractive]{ss20}\BFill[loweractive]{ss21}\BFill[loweractive]{ss22}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\BFill[loweractive]{ss31}\TFill[upperactive]{ss32}\BFill[loweractive]{ss32}\BFill[loweractive]{ss33}} % state after AK
{\BFill[loweractive]{ss00}\BFill[loweractive]{ss01}\BFill[loweractive]{ss02}\BFill[loweractive]{ss03}\BFill[loweractive]{ss10}\BFill[loweractive]{ss11}\BFill[loweractive]{ss12}\BFill[loweractive]{ss13}\BFill[loweractive]{ss20}\BFill[loweractive]{ss21}\BFill[loweractive]{ss22}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\BFill[loweractive]{ss31}\TFill[upperactive]{ss32}\BFill[loweractive]{ss32}\BFill[loweractive]{ss33}} % state after SB
{\BFill[loweractive]{ss00}\BFill[loweractive]{ss01}\BFill[loweractive]{ss02}\BFill[loweractive]{ss03}\BFill[loweractive]{ss10}\BFill[loweractive]{ss11}\BFill[loweractive]{ss12}\BFill[loweractive]{ss13}\BFill[loweractive]{ss20}\BFill[loweractive]{ss21}\BFill[loweractive]{ss22}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\BFill[loweractive]{ss31}\BFill[loweractive]{ss32}\TFill[upperactive]{ss33}\BFill[loweractive]{ss33}} % state after SR

\AesNewLine[2]{\BFill[loweractive]{ss01}\TFill[upperactive]{ss03}\BFill[loweractive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss23}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\TFill[upperactive]{ss33}}
\AesRound[2]
{\BFill[loweractive]{ss01}\TFill[upperactive]{ss03}\BFill[loweractive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss23}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\TFill[upperactive]{ss33}} % state input
{} % round key
{\BFill[loweractive]{ss01}\TFill[upperactive]{ss03}\BFill[loweractive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss23}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\TFill[upperactive]{ss33}} % state after AK
{\BFill[loweractive]{ss01}\TFill[upperactive]{ss03}\BFill[loweractive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss23}\BFill[loweractive]{ss23}\BFill[loweractive]{ss30}\TFill[upperactive]{ss33}} % state after SB
{\BFill[loweractive]{ss01}\TFill[upperactive]{ss03}\BFill[loweractive]{ss11}\TFill[upperactive]{ss12}\TFill[upperactive]{ss21}\BFill[loweractive]{ss21}\TFill[upperactive]{ss30}\BFill[loweractive]{ss31}} % state after SR

\AesRound[3]
{\TFill[upperactive]{ss00}\TFill[upperactive]{ss01}\TFill[upperactive]{ss02}\TFill[upperactive]{ss03}\TFill[upperactive]{ss10}\TFill[upperactive]{ss11}\TFill[upperactive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss21}\TFill[upperactive]{ss22}\TFill[upperactive]{ss23}\TFill[upperactive]{ss30}\TFill[upperactive]{ss31}\BFill[loweractive]{ss31}\TFill[upperactive]{ss32}\TFill[upperactive]{ss33}} % state input
{} % round key
{\TFill[upperactive]{ss00}\TFill[upperactive]{ss01}\TFill[upperactive]{ss02}\TFill[upperactive]{ss03}\TFill[upperactive]{ss10}\TFill[upperactive]{ss11}\TFill[upperactive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss21}\TFill[upperactive]{ss22}\TFill[upperactive]{ss23}\TFill[upperactive]{ss30}\TFill[upperactive]{ss31}\BFill[loweractive]{ss31}\TFill[upperactive]{ss32}\TFill[upperactive]{ss33}} % state after AK
{\TFill[upperactive]{ss00}\TFill[upperactive]{ss01}\TFill[upperactive]{ss02}\TFill[upperactive]{ss03}\TFill[upperactive]{ss10}\TFill[upperactive]{ss11}\TFill[upperactive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss21}\TFill[upperactive]{ss22}\TFill[upperactive]{ss23}\TFill[upperactive]{ss30}\TFill[upperactive]{ss31}\BFill[loweractive]{ss31}\TFill[upperactive]{ss32}\TFill[upperactive]{ss33}} % state after SB
{\TFill[upperactive]{ss00}\TFill[upperactive]{ss01}\TFill[upperactive]{ss02}\TFill[upperactive]{ss03}\TFill[upperactive]{ss10}\TFill[upperactive]{ss11}\TFill[upperactive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss21}\TFill[upperactive]{ss22}\TFill[upperactive]{ss23}\TFill[upperactive]{ss30}\TFill[upperactive]{ss31}\TFill[upperactive]{ss32}\BFill[loweractive]{ss32}\TFill[upperactive]{ss33}} % state after SR

\AesFin[4]{\TFill[upperactive]{ss00}\TFill[upperactive]{ss01}\TFill[upperactive]{ss02}\BFill[loweractive]{ss02}\TFill[upperactive]{ss03}\TFill[upperactive]{ss10}\TFill[upperactive]{ss11}\TFill[upperactive]{ss12}\BFill[loweractive]{ss12}\TFill[upperactive]{ss13}\TFill[upperactive]{ss20}\TFill[upperactive]{ss21}\TFill[upperactive]{ss22}\BFill[loweractive]{ss22}\TFill[upperactive]{ss23}\TFill[upperactive]{ss30}\TFill[upperactive]{ss31}\TFill[upperactive]{ss32}\BFill[loweractive]{ss32}\TFill[upperactive]{ss33}}
\end{tikzpicture}
%\end{figure}
\begin{comment}
Attack summary:
Setting: RU: 1, RM: 3, RL: 0, RMU: 0, RML: 1
##################################################
PU:  4
CM:  3
Q^2: 0
##################################################
##################################################
Upper trail:
Rounds	x                                 s                                 y                                 z                                 k                                 pr     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0	00002c00000000af3f000000006b0000  000012000000001a16000000001c0000  0000120000001a000000160000001c00  00000000000000000000000000000200  00000000000000000000000000000000  -24.0                             
1	00000000000000000000000000000200  none                              none                              none                              none                              none                              

Weight: -24.00
##################################################
Sandwich 3 rounds in the middle
char DP_STR[] = "00000000000000000000000200000000";
char LC_STR[] = "0000000000000000bb03947300000000";
##################################################
Lower trail:
Rounds	x                                 s                                 y                                 pr     
--------------------------------------------------------------------------------------------------------------------
0	000000000000000000000000005d0000  000000000000000000000000005f0000  00000000000000000000000000005f00  -6.0                              
1	0000bb00000003000000940000007300  none                              none                              none                              

Weight: -6.00
##################################################
Differential effect of the upper differential trail: 2^(-24.0)
Number of common active S-boxes in the middle      : 3
Squared correaltion of the lower linear trail      : 2^(0)
Expected correlation for the 3 middle rounds       : 2^(-7.97)
Expected correlation for 4 rounds                  : 2^(-31.97)
\end{comment}
\end{document}